{"version":3,"sources":["webpack:///./src/app/app.component.css","webpack:///./src/app/reader/reader.component.css","webpack:///./src/app/viewer/viewer.component.css","webpack:///./src/app/app.component.html","webpack:///./src/app/reader/reader.component.html","webpack:///./src/app/viewer/viewer.component.html","webpack:///./src/app/lib/args.ts","webpack:///./src async","webpack:///./src/main.ts","webpack:///./src/app/app.component.ts","webpack:///./src/app/app.module.ts","webpack:///./src/app/lib/touchbar.ts","webpack:///./src/app/lib/util.ts","webpack:///./src/app/reader/book.ts","webpack:///./src/app/reader/reader.component.ts","webpack:///./src/app/trust-resource-url.pipe.ts","webpack:///./src/app/viewer/viewer.component.ts","webpack:///./src/environments/environment.ts"],"names":[],"mappings":"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","file":"main.bundle.js","sourcesContent":["exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".titlebar {\\n  height: 28px;\\n  -webkit-app-region: drag;\\n  position: fixed;\\n  top: 0;\\n  left: 0;\\n  right: 0;\\n}\\n\\nreader {\\n  position: fixed;\\n  top: 0;\\n  right: 0;\\n  bottom: 0;\\n  left: 0;\\n}\\n\", \"\"]);\n\n// exports\n\n\n/*** EXPORTS FROM exports-loader ***/\nmodule.exports = module.exports.toString();\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/app.component.css\n// module id = 140\n// module chunks = 1","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \"::-webkit-scrollbar {\\n  width: 0;\\n  height: 0;\\n}\\n\\n:host {\\n  position: absolute;\\n  top: 0;\\n  right: 0;\\n  bottom: 0;\\n  left: 0;\\n}\\n\\nsection.pages {\\n  position: absolute;\\n  top: 0;\\n  right: 0;\\n  bottom: 0;\\n  left: 0;\\n  display: -webkit-box;\\n  display: -ms-flexbox;\\n  display: flex;\\n  -webkit-box-orient: vertical;\\n  -webkit-box-direction: normal;\\n      -ms-flex-flow: column nowrap;\\n          flex-flow: column nowrap;\\n  overflow-x: hidden;\\n  overflow-y: auto;\\n}\\n\\nviewer {\\n  width: 100%;\\n}\\n\\n.layer {\\n  position: absolute;\\n  top: 0;\\n  right: 0;\\n  bottom: 0;\\n  left: 0;\\n}\\n\\n.layer {\\n  pointer-events: none;\\n}\\n\\n.layer .panel {\\n  position: absolute;\\n  background-color: #222;\\n  border-radius: 10px;\\n  color: #ccc;\\n  opacity: 0.8;\\n  padding: 10px 14px 8px 14px;\\n  font-family: 'Monaco', sans-serif;\\n  font-size: 14px;\\n}\\n\\n.progress {\\n  display: inline-block;\\n  top: 18px;\\n  right: 18px;\\n}\\n\\n.ctrl {\\n  display: -webkit-box;\\n  display: -ms-flexbox;\\n  display: flex;\\n  -webkit-box-align: stretch;\\n      -ms-flex-align: stretch;\\n          align-items: stretch;\\n}\\n\\n.ctrl .panel {\\n  -webkit-box-flex: 1;\\n      -ms-flex: 1;\\n          flex: 1;\\n}\\n\", \"\"]);\n\n// exports\n\n\n/*** EXPORTS FROM exports-loader ***/\nmodule.exports = module.exports.toString();\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/reader/reader.component.css\n// module id = 141\n// module chunks = 1","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \"/*.viewer {*/\\n/*position: absolute;*/\\n/*top: 0;*/\\n/*right: 0;*/\\n/*bottom: 0;*/\\n/*left: 0;*/\\n/*overflow: auto;*/\\n/*display: flex;*/\\n/*align-items: center;*/\\n/*justify-content: flex-start;*/\\n/*}*/\\n\\n/*.viewer.x {*/\\n/*flex-direction: row;*/\\n/*}*/\\n\\n/*.viewer.y {*/\\n/*flex-direction: column;*/\\n/*}*/\\n\\n/*.viewer.tiny {*/\\n/*justify-content: center;*/\\n/*}*/\\n\\n/*.viewer.huge img {*/\\n/*position: absolute;*/\\n/*top: 0;*/\\n/*left: 0;*/\\n/*}*/\\n\\n/*.x img {*/\\n/*max-width: 100vw;*/\\n/*}*/\\n\\n/*.y img {*/\\n/*max-height: 100vh;*/\\n/*}*/\\n\\n/*img {*/\\n/*box-shadow: 0 0 32px 4px rgba(0, 0, 0, 0.4);*/\\n/*transition: 75ms ease-out;*/\\n/*}*/\\n\\n/*::-webkit-scrollbar {*/\\n/*width: 0;*/\\n/*height: 0;*/\\n/*}*/\\n\\n/*:host {*/\\n/*overflow: scroll;*/\\n/*}*/\\n\\nsection {\\n  border: 4px solid blue;\\n  /*background-color: rgba(0, 0, 0, 0.6);*/\\n  text-align: center;\\n}\\n\\n.loading {\\n  /*height: 100vh;*/\\n  height: 30vh;\\n  display: -webkit-box;\\n  display: -ms-flexbox;\\n  display: flex;\\n  -webkit-box-align: center;\\n      -ms-flex-align: center;\\n          align-items: center;\\n  -webkit-box-pack: center;\\n      -ms-flex-pack: center;\\n          justify-content: center;\\n  color: white;\\n  font-family: \\\"American Typewriter\\\", monospace;\\n  font-size: 2.5vh;\\n  opacity: 0.8;\\n}\\n\\nimg {\\n  /*border: 4px solid red;*/\\n  max-width: 100%;\\n  /*max-height: 133vh;*/\\n}\\n\", \"\"]);\n\n// exports\n\n\n/*** EXPORTS FROM exports-loader ***/\nmodule.exports = module.exports.toString();\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/viewer/viewer.component.css\n// module id = 142\n// module chunks = 1","module.exports = \"<reader [path]=\\\"path\\\"></reader>\\n<header class=\\\"titlebar\\\"></header>\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/app.component.html\n// module id = 147\n// module chunks = 1","module.exports = \"<!--<viewer-->\\n<!--*ngFor=\\\"img in book.pages(_)\\\"-->\\n<!--[img]=\\\"img\\\"-->\\n<!--[scale]=\\\"scale\\\"-->\\n<!--(click)=\\\"next()\\\">-->\\n<!--</viewer>-->\\n<section class=\\\"pages\\\">\\n  <viewer *ngFor=\\\"let p of book?.meta?.Pages; let i = index;\\\"\\n          [class]=\\\"i\\\"\\n          [cache]=\\\"inCacheRange(recorder.stack, i)\\\"\\n          [path]=\\\"book?.getPageFilePath(p.Id)\\\"\\n          (click)=\\\"book?.next()\\\">\\n  </viewer>\\n  <!--[hidden]=\\\"i!==book?.current-1\\\"-->\\n</section>\\n<section class=\\\"layer\\\">\\n  <section class=\\\"panel progress\\\">\\n    {{book?.current}} / {{book?.total}}\\n  </section>\\n</section>\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/reader/reader.component.html\n// module id = 148\n// module chunks = 1","module.exports = \"<section class=\\\"viewer\\\"\\n         [class]=\\\"classNames.get()\\\"\\n>\\n  <!--[class.y]=\\\"!isX(img)\\\"-->\\n  <!--[class.tiny]=\\\"isTiny(img)\\\"-->\\n  <!--[class.huge]=\\\"isHuge(img)\\\">-->\\n  <!--<img *ngIf=\\\"img?.src\\\"-->\\n  <!--[src]=\\\"img?.src | trustResourceUrl\\\"-->\\n  <!--[style.maxWidth.%]=\\\"scale\\\"-->\\n  <div class=\\\"loading\\\"\\n       *ngIf=\\\"!show\\\">\\n    <div>loading...</div>\\n    {{show}}\\n  </div>\\n  <img #img [src]=\\\"path\\\"\\n       *ngIf=\\\"cache\\\"\\n       [hidden]=\\\"!show\\\"\\n       (load)=\\\"onLoad($event, img)\\\">\\n</section>\\n<!--[style.maxHeight.vh]=\\\"100\\\"-->\\n<!--<div style=\\\"color: white;\\\">{{img?.src}}</div>-->\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/viewer/viewer.component.html\n// module id = 149\n// module chunks = 1","const qs = require('querystring');\nconst {ipcRenderer} = window['require']('electron');\n\nexport class Args {\n  path: string;\n  port: number;\n  _promise: Promise<any>;\n  _resolve: Function;\n\n  constructor() {\n    this._promise = new Promise(resolve => this._resolve = resolve);\n  }\n\n  check() {\n    if (this._resolve && this.path && this.port) {\n      this._resolve();\n    }\n  }\n\n  wait() {\n    return this._promise;\n  }\n}\n\nconst args: Args = new Args();\n\nipcRenderer.on('path', (event, message) => {\n  console.log('path:', message);\n  args.path = message;\n  args.check();\n});\nipcRenderer.on('port', (event, message) => {\n  console.log('port:', message);\n  args.port = message;\n  args.check();\n});\n\nexport default args;\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/lib/args.ts","function webpackEmptyContext(req) {\n\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 70;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src async\n// module id = 70\n// module chunks = 1","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule);\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.ts","import {Component, OnInit} from '@angular/core';\nimport args from \"./lib/args\";\nconst electron = window['require']('electron');\nconst {webFrame} = electron;\nconst {dialog, getCurrentWindow} = electron.remote;\n\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css']\n})\nexport class AppComponent implements OnInit {\n  path: string;\n\n  constructor() {\n\n  }\n\n  async ngOnInit() {\n    webFrame.setVisualZoomLevelLimits(1, 1);\n    const win = getCurrentWindow();\n    await args.wait();\n    const path = args.path;\n    console.log('Open From FileAssociation:', path);\n    if (path) {\n      this.path = path;\n    }\n    // check is user folder\n    // check path has images\n    // const isUserImagesFolder = false;\n    if (this.path) {\n      this.path = dialog.showOpenDialog({properties: ['openFile', 'openDirectory']}).pop();\n    }\n    // this.path = '/Users/shixiao/Pictures';\n    // this.path = '/Users/shixiao/Downloads/a/top20/8';\n    win.show();\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/app.component.ts","import {BrowserModule} from '@angular/platform-browser';\nimport {NgModule} from '@angular/core';\nimport {FormsModule} from '@angular/forms';\nimport {HttpModule} from '@angular/http';\n\nimport {AppComponent} from './app.component';\nimport {ViewerComponent} from './viewer/viewer.component';\nimport {TrustResourceUrlPipe} from './trust-resource-url.pipe';\nimport {ReaderComponent} from './reader/reader.component';\n\n@NgModule({\n  declarations: [\n    AppComponent,\n    ViewerComponent,\n    ReaderComponent,\n    TrustResourceUrlPipe\n  ],\n  imports: [\n    BrowserModule,\n    FormsModule,\n    HttpModule\n  ],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/app.module.ts","const electron = window['require']('electron');\nconst {getCurrentWindow, TouchBar} = electron.remote;\nconst {TouchBarButton, TouchBarColorPicker, TouchBarGroup, TouchBarLabel, TouchBarPopover, TouchBarSlider, TouchBarSpacer} = TouchBar;\n\nconst setTouchBar = function (args: any) {\n  const win = getCurrentWindow();\n  const touchBar = new TouchBar(args);\n  win.setTouchBar(touchBar);\n};\n\nexport {\n  setTouchBar,\n  TouchBarButton,\n  TouchBarColorPicker,\n  TouchBarGroup,\n  TouchBarLabel,\n  TouchBarPopover,\n  TouchBarSlider,\n  TouchBarSpacer\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/lib/touchbar.ts","import Timer = NodeJS.Timer;\n\nexport class IntervalTimer {\n  lastRunTime: number;\n  timer: Timer;\n\n  constructor() {\n  }\n\n  run(callback: Function, delay: number = 100) {\n    const now = Date.now();\n    if ((now - this.lastRunTime) > delay) {\n      this.lastRunTime = now;\n      callback();\n    } else {\n      if (this.timer) {\n        clearTimeout(this.timer);\n      }\n      this.timer = setTimeout(() => {\n        this.lastRunTime = now;\n        callback();\n      }, delay - (now - this.lastRunTime));\n    }\n  }\n}\n\nexport class EnterLeaveRecorder {\n  io: IntersectionObserver;\n  stack: string[] = [];\n\n  constructor(cb: IntersectionObserverCallback, opt?: IntersectionObserverInit) {\n    this.io = new IntersectionObserver(cb, opt);\n  }\n\n  top() {\n    return this.stack[this.stack.length - 1];\n  }\n\n  // intersect(...ids: string[]): boolean {\n  //   return ids.map(id => this.stack.includes(id)).some(b => b);\n  // }\n\n  toggle(id: string) {\n    const index = this.stack.indexOf(id);\n    if (index < 0) {\n      this.stack.push(id);\n    } else {\n      this.stack.splice(index, 1);\n    }\n    return this.top();\n  }\n\n}\n\nexport class Dismiss {\n  constructor(private times: number) {\n  }\n\n  run(cb: Function) {\n    if (this.times > 0) {\n      this.times--;\n    } else {\n      cb();\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/lib/util.ts","import {BookMeta} from \"./meta\";\nimport args from \"../lib/args\";\n\nexport class Book {\n  locator: string;\n  meta: BookMeta;\n  _current: number;\n  total: number;\n  _onPage: Function[] = [];\n\n  constructor(path: string) {\n    this.locator = path;\n  }\n\n  get current(): number {\n    return this._current;\n  }\n\n  set current(page: number) {\n    const old = this._current;\n    this._current = page;\n    this._onPage.forEach(cb => cb(page, old));\n  }\n\n  async init() {\n    await args.wait();\n    const url = `http://localhost:${args.port}/book?locator=${this.locator}`;\n    const data = await fetch(url);\n    this.meta = await data.json();\n    this.total = this.meta.Pages.length;\n    this.current = 1;\n  }\n\n  goto(pageOrOffset: number, relative: boolean = false): boolean {\n    const page = relative ? this.current + pageOrOffset : pageOrOffset;\n    if (page > 0 && page <= this.total) {\n      this.current = page;\n      return true;\n    }\n  }\n\n  prev(): boolean {\n    return this.goto(-1, true);\n  }\n\n  next(): boolean {\n    return this.goto(1, true);\n  }\n\n  getPageFilePath(id: string) {\n    return `http://localhost:${args.port}/book/page?locator=${this.locator}&page=${id}`;\n  }\n\n  onPage(callback: (n?: number, old?: number) => void) {\n    this._onPage.push(callback);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/reader/book.ts","import {Component, OnInit, Input, HostListener, NgZone, OnChanges} from '@angular/core';\nimport {setTouchBar, TouchBarButton, TouchBarSlider} from \"../lib/touchbar\";\nimport {Dismiss, EnterLeaveRecorder, IntervalTimer} from \"../lib/util\";\nimport {Book} from \"./book\";\nconst fs = window['require']('fs');\n\n@Component({\n  selector: 'reader',\n  templateUrl: './reader.component.html',\n  styleUrls: ['./reader.component.css'],\n})\nexport class ReaderComponent implements OnInit, OnChanges {\n\n  @Input() path: string;\n  book: Book;\n  scale: number = 100;\n  recorder: EnterLeaveRecorder;\n\n  // todo: multi-viewer: cache and better loading\n\n  @HostListener('window:contextmenu', ['$event']) onRightClick() {\n  }\n\n  constructor(private zone: NgZone) {\n  }\n\n  async ngOnInit() {\n  }\n\n  onready() {\n    console.log('onready');\n  }\n\n  async ngOnChanges(changes) {\n    if (changes.path && this.path) {\n      this.book = new Book(this.path);\n      await this.book.init();\n\n      //\n      if (this.recorder) {\n        this.recorder.io.disconnect();\n      }\n      this.recorder = new EnterLeaveRecorder((entries) => {\n        const top = +entries.map(e => this.recorder.toggle('' + (+e.target.className + 1))).pop();\n        this.zone.run(() => this.book.goto(top));\n      }, {threshold: [0.5]});\n      setTimeout(() => {\n        Array.prototype.slice.call(document.querySelectorAll('viewer')).forEach(node => this.recorder.io.observe(node));\n      }, 0);\n      // touchBar\n      const getProgressStr = (current: number = this.book.current) => current + '/' + this.book.total;\n      const getRealVal = (selectedVal: number) => this.book.total > 100 ? selectedVal : Math.max(1, Math.round(this.book.total * selectedVal / 100));\n      const getSelectedVal = (current: number = this.book.current) => this.book.total > 100 ? current : Math.ceil(current / this.book.total * 100);\n      const slideTimer = new IntervalTimer();\n      const slider = new TouchBarSlider({\n        label: getProgressStr(),\n        value: getSelectedVal(),\n        minValue: 1,\n        maxValue: Math.max(100, this.book.total),\n        change: (newValue: number) => {\n          const current = getRealVal(newValue);\n          slider.label = getProgressStr(current);\n          slideTimer.run(() => this.zone.run(() => this.book.current = current), 75);\n        }\n      });\n      this.book.onPage((current) => {\n        slider.value = getSelectedVal(current);\n        slider.label = getProgressStr(current);\n      });\n      setTouchBar([\n        new TouchBarButton({label: 'Front', click: () => this.zone.run(() => this.book.goto(1))}),\n        slider,\n        new TouchBarButton({label: 'ZoomIn', click: () => this.zoom(-10)}),\n        new TouchBarButton({label: 'ZoomOut', click: () => this.zoom(10)}),\n      ]);\n    }\n  }\n\n  zoom(percent: number) {\n    this.zone.run(() => {\n      this.scale += percent;\n    });\n  }\n\n  @HostListener('window:keydown.pageUp', ['$event'])\n  @HostListener('window:keydown.arrowUp', ['$event'])\n  @HostListener('window:keydown.arrowLeft', ['$event'])\n  prev() {\n    if (this.book) {\n      this.zone.run(() => {\n        this.book.prev();\n      });\n    }\n  };\n\n  @HostListener('window:keydown.pageDown', ['$event'])\n  @HostListener('window:keydown.arrowDown', ['$event'])\n  @HostListener('window:keydown.arrowRight', ['$event'])\n  next() {\n    if (this.book) {\n      this.zone.run(() => {\n        this.book.next();\n      });\n    }\n  };\n\n  // private inCacheRange(page: number): boolean {\n  //   const BACKWARD = 2;\n  //   const FORWARD = 5;\n  //   const current = this.book.current;\n  //   if (current - BACKWARD <= page && page <= current + FORWARD) {\n  //     return true;\n  //   }\n  // }\n  inCacheRange(set: number[], p: number): boolean {\n    const distance = ((set: number[], p: number) => {\n      let min = 1e10;\n      set.forEach(s => {\n        const d = s - p;\n        if (Math.abs(d) < Math.abs(min)) {\n          min = d;\n        }\n      });\n      return min;\n    })(set, p);\n    const BACKWARD = 2;\n    const FORWARD = 5;\n    return -1 * BACKWARD <= distance && distance <= FORWARD;\n  }\n\n  // @HostListener('window:mousewheel', ['$event'])\n  // async onWheel(e) {\n  // if (e.deltaY > 0) {\n  //   await this.next();\n  // } else {\n  //   await this.prev();\n  // }\n  // }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/reader/reader.component.ts","import {Pipe, PipeTransform} from '@angular/core';\nimport {DomSanitizer} from '@angular/platform-browser';\n\n@Pipe({\n  name: 'trustResourceUrl'\n})\nexport class TrustResourceUrlPipe implements PipeTransform {\n  sanitizer: DomSanitizer;\n\n  constructor(_s: DomSanitizer) {\n    this.sanitizer = _s;\n  }\n\n  transform(value: any, args?: any): any {\n    return this.sanitizer.bypassSecurityTrustResourceUrl(value);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/trust-resource-url.pipe.ts","import {Component, OnInit, Input, OnChanges} from '@angular/core';\nconst getWindowSize = () => {\n  return [window.innerWidth, window.innerHeight];\n};\nclass ClassNames {\n  names: string[] = [];\n\n  get(): string[] {\n    return this.names;\n  }\n\n  clear() {\n    this.names = [];\n  }\n\n  add(c: string) {\n    this.names.push(c);\n  }\n}\n\n@Component({\n  selector: 'viewer',\n  templateUrl: './viewer.component.html',\n  styleUrls: ['./viewer.component.css']\n})\nexport class ViewerComponent implements OnInit, OnChanges {\n  @Input() path: string;\n  @Input() scale: number;\n  @Input() cache: boolean;\n  show: boolean = false;\n  classNames: ClassNames = new ClassNames();\n\n  constructor() {\n  }\n\n  async ngOnInit() {\n  }\n\n  ngOnChanges(changes) {\n    if (changes.path || changes.scale) {\n      // console.timeEnd('overall');\n    }\n  }\n\n  // isX(img?: HTMLImageElement) {\n  //   if (img) {\n  //     const [w, h] = getWindowSize();\n  //     return img.width / img.height > w / h;\n  //   }\n  // }\n\n  //\n  // isTiny(img?: ImageMeta) {\n  //   if (img) {\n  //     const [w, h] = getWindowSize();\n  //     return this.scale < 100 || (img.width < w && img.height < h);\n  //   }\n  // }\n  //\n  // isHuge(img?: ImageMeta) {\n  //   if (img) {\n  //     const [w, h] = getWindowSize();\n  //     const ratio = this.scale / 100;\n  //     return img.width * ratio > w && img.height * ratio > h;\n  //   }\n  // }\n\n  // max(img?: ImageMeta) {\n  //   return this.isTiny(img) ? 100 : this.scale;\n  // }\n  //\n  onLoad(e, img) {\n    this.refresh(img);\n  }\n\n  refresh(img) {\n    // console.table([{'width': img.width, 'height': img.height}]);\n    this.classNames.add('y');\n    this.show = true;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/viewer/viewer.component.ts","// The file contents for the current environment will overwrite these during build.\n// The build system defaults to the dev environment which uses `environment.ts`, but if you do\n// `ng build --env=prod` then `environment.prod.ts` will be used instead.\n// The list of which env maps to which file can be found in `.angular-cli.json`.\n\nexport const environment = {\n  production: false\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/environments/environment.ts"],"sourceRoot":""}